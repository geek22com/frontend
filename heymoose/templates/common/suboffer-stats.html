{% import 'common/macros/lists.html' as lists with context %}

{% macro head() %}
<style type="text/css">
	td.exclusive {
		background-image: url('{{ url_for('static', filename='img/icon-star.png') }}');
		background-repeat: no-repeat;
		background-position: 10px center;
		padding-left: 30px;
	}
</style>
{% endmacro %}

{% macro table(stats, empty='Нет данных для получения статистики.') %}
{% if stats %}
	<table class="bordered-table zebra-striped stats-table">
		<thead>
			<tr>
				<th rowspan="2" {{ lists.sort_header('descr', **kwargs) }}>Название</th>
				<th class="center" colspan="3">Действия</th>
				<th class="center" colspan="3">Финансы,&nbsp;{{ currency_sign -}}</th>
			</tr>
			<tr class="subrow">
				<th style="min-width: 70px;" {{ lists.sort_header('canceled_action_count', 'red', **kwargs) }}>Откл.</th>
				<th style="min-width: 70px;" {{ lists.sort_header('not_confirmed_action_count', **kwargs) }}>Неподтв.</th>
				<th style="min-width: 70px;" {{ lists.sort_header('confirmed_action_count', 'green', **kwargs) }}>Подтв.</th>

				<th style="min-width: 70px;" {{ lists.sort_header('canceled_revenue', 'red', **kwargs) }}>Откл.</th>
				<th style="min-width: 70px;" {{ lists.sort_header('not_confirmed_revenue', **kwargs) }}>Неподтв.</th>
				<th style="min-width: 70px;" {{ lists.sort_header('confirmed_revenue', 'green', **kwargs) }}>Подтв.</th>
			</tr>
		</thead>
		<tbody>
			{% for stat in stats %}
			<tr>
				<td {% if stat.exclusive %}class="exclusive"{% endif %}>{{ stat.name }}</td>
				
				<td class="right red">{{ stat.cancelled_action_count }}</td>
				<td class="right">{{ stat.not_confirmed_action_count }}</td>
				<td class="right green">{{ stat.confirmed_action_count }}</td>

				<td class="right red">{{ stat.cancelled_revenue }}</td>
				<td class="right">{{ stat.not_confirmed_revenue }}</td>
				<td class="right green">{{ stat.confirmed_revenue }}</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
	{{ lists.paginate(pages, **kwargs) }}
{% else %}
	<div class="clearfix alert-message block-message info">
		<p>{{ empty }}</p>
	</div>
{% endif %}
{% endmacro %}
