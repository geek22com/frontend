{% extends "admin/offers/info/layout.html" %}
{% import 'common/macros/lists.html' as lists with context %}
{% import 'common/forms/datetime-range.html' as datetime_range %}

{% set activetab = 'finances' %}

{% block extrahead %}
	{{ super() }}
	{{ datetime_range.head() }}
{% endblock %}

{% block tabcontent %}

{{ datetime_range.html(form, 'Показать задолженность за период:') }}

{% if debts %}
	<table class="bordered-table zebra-striped nosort">
		<thead>
			<tr>
				<th>Статья</th>
				<th class="right">Доход, руб.</th>
				<th class="right">Выплачено, руб.</th>
				<th class="right">Задолженность, руб.</th>
				<th class="right">Заказано, руб.</th>
			</tr>
		</thead>
		<tbody>
			{% for debt in debts %}
			<tr>
				<td>
					{% if debt.is_affiliate_revenue %}
					Задолженность партнёру <a href="{{ url_for('.users_info', id=debt.user_id) }}">{{ debt.user_email }}</a>
					{% else %}
					Комиссия системы
					{% endif %}
				</td>
				<td class="right">{{ debt.income_amount|currency(false) }}</td>
				<td class="right">{{ debt.payed_out_amount|currency(false) }}</td>
				<td class="right">{{ debt.debt_amount|currency(false) }}</td>
				<td class="right">{{ debt.ordered_amount|currency(false) }}</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
	{{ lists.paginate(pages, **form.query_args()) }}
{% else %}
	<div class="clearfix alert-message block-message info">
		<p>За выбранный период не было активности по офферу.</p>
	</div>
{% endif %}

{% endblock %}
