{% extends "cabinet/info-layout.html" %}

{% set activetab = 'info' %}

{% block tabcontent %}
{% with user = g.user %}
<table class="key-value">
	<tbody>
		<tr><th>Имя</th><td>{{ user.full_name() }}</td></tr>
		<tr><th>Организация</th><td>{{ user.organization|default('(не указана)', true) }}</td></tr>
	</tbody>
</table>

<h3>Контакты</h3>
<table class="key-value">
	<tbody>
		<tr><th>E-mail</th><td>{{ user.email }}</td></tr>
		<tr><th>Телефон</th><td>{{ user.phone|default('(не указан)', true) }}</td></tr>
		<tr>
			<th>Мессенджер</th>
			<td>
				{% if user.messenger_type %}
				{{ user.messenger_uid }} ({{ user.messenger_type }})
				{% else %}
				(не указан)
				{% endif %}
			</td>
		</tr>
	</tbody>
</table>

{% if user.is_developer() %}
<h3>Разработчик</h3>
<table class="key-value">
	<tbody>
		<tr><th>Баланс</th><td>{{ user.developer_account.balance|currency }}</td></tr>
	</tbody>
</table>
{% endif %}

{% if user.is_customer() %}
<h3>Рекламодатель</h3>
<table class="key-value">
	<tbody>
		<tr><th>Баланс</th><td>{{ user.customer_account.balance|currency }}</td></tr>
		<tr><th>Секретный ключ</th><td>{{ user.customer_secret }}</td></tr>
		{% with ref = url_for('site.register', ref=user.get_refcode()) %}
		<tr><th>Реферальная ссылка</th><td><a href="{{ ref }}">http://heymoose.com{{ ref }}</a></td></tr>
		{% endwith %}
		<tr>
			<th>Рефералы</th>
			<td>
				{% for referral in user.referrals %}
				<p><a href="mailto:{{ referral }}">{{ referral }}</a></p>
				{% else %}
				(нет)
				{% endfor %}
			</td>
		</tr>
		<tr><th>Доход от рефералов</th><td>{{ user.revenue }}</td></tr>
	</tbody>
</table>
{% endif %}
{% endwith %}
{% endblock %}
